<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pfcbuy.order.mapper.OrderMapper">

    <resultMap id="BaseResultMap" type="com.pfcbuy.order.entity.Order">
        <id column="id" property="id"/>
        <result column="order_no" property="orderNo"/>
        <result column="user_id" property="userId"/>
        <result column="order_status" property="orderStatus"/>
        <result column="pay_status" property="payStatus"/>
        <result column="total_amount" property="totalAmount"/>
        <result column="paid_amount" property="paidAmount"/>
        <result column="currency" property="currency"/>
        <result column="exchange_rate" property="exchangeRate"/>
        <result column="shipping_fee" property="shippingFee"/>
        <result column="discount_amount" property="discountAmount"/>
        <result column="remark" property="remark"/>
        <result column="user_remark" property="userRemark"/>
        <result column="admin_remark" property="adminRemark"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
        <result column="is_deleted" property="isDeleted"/>
    </resultMap>

    <!-- 根据订单号查询订单 -->
    <select id="selectByOrderNo" parameterType="string" resultMap="BaseResultMap">
        SELECT *
        FROM orders
        WHERE order_no = #{orderNo}
          AND is_deleted = 0
    </select>

    <!-- 更新订单状态 -->
    <update id="updateOrderStatus">
        UPDATE orders
        SET order_status = #{orderStatus},
            update_time  = NOW()
        WHERE id = #{id}
    </update>

    <!-- 更新支付状态 -->
    <update id="updatePayStatus">
        UPDATE orders
        SET pay_status  = #{payStatus},
            update_time = NOW()
        WHERE id = #{id}
    </update>

</mapper>
